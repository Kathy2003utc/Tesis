{% load static %}

<!DOCTYPE html>
<html lang="es">
<head>
    
    <link rel="manifest" href="{% static 'pwa/manifest.json' %}">
    <meta name="theme-color" content="#8A5A3C">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <meta charset="UTF-8">
    <title>Iniciar sesión - Restaurante</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- jQuery Validate -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>

    <style>
        :root {
        /* Colores base del logo */
        --cafe-oscuro: #b4764f;
        --cafe-medio: #cd966c;
        --cafe-claro: #D7B999;
        --cafe-suave: #EEDDC6;

        /* Verdes del logo */
        --verde: #3E7A3F;
        --verde-claro: #7FBF6A;

        /* Neutros principales */
        --blanco-calido: #F8F5F2;
        --gris-suave: #E2DED8;
        --texto-oscuro: #2B1A10;

        /* Alertas */
        --rojo-alerta: #C14949;
        --rojo-oscuro: #8C2F39;

        /* Tonos café elegantes */
        --cafe-profundo: #8A5A3C;
        --cafe-tostado: #A66E4A;
        --cafe-avellana: #C8A784;
        --cafe-crema: #F0E1CA;

        /* Verdes complementarios */
        --verde-profundo: #2E5F32;
        --verde-oliva: #5E7A43;
        --verde-menta: #A6D5A1;
        --verde-musgo: #507B4C;

        /* Neutros cálidos */
        --crema-suave: #FAF4EC;
        --gris-claro-calido: #D8D3CC;
        --gris-medio-calido: #B8B1A8;
        --gris-oscuro-calido: #4A3F38;

        /* Azules compatibles */
        --azul-pizarra: #4F6D7A;
        --azul-gris: #7A8C99;

        /* Acentos cálidos */
        --naranja-tierra: #D98555;
        --naranja-arcilla: #C66B3D;
        --dorado-suave: #D9B77A;

        /* Estados */
        --exito: #4F8A57;
        --exito-suave: #D9F2D6;
        --info: #6A93B0;
        --info-suave: #DDE9F2;
        --advertencia: #D9A441;
        --advertencia-suave: #FFF5DA;
    }

        body {
            background: linear-gradient(
                135deg,
                var(--crema-suave),
                var(--cafe-suave) 45%,
                var(--blanco-calido)
        );
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Poppins', sans-serif;
        }

        .login-card {
            border: none;
            border-radius: 1.5rem;
            overflow: hidden;
            background: var(--blanco-calido);
            box-shadow: 0px 10px 40px rgba(0, 0, 0, 0.35);
        }

        .bg-login-image {
            background: url('https://source.unsplash.com/featured/?coffee,cafe') no-repeat center;
            background-size: cover;
        }

        .restaurant-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--cafe-oscuro);
        }

        /* Inputs */
        .form-control {
            border-radius: .6rem;
            border: 2px solid var(--cafe-claro);
            background-color: #fff;
            font-size: 1rem;
            transition: .2s;
        }

        .form-control:focus {
            border-color: var(--verde);
            box-shadow: 0 0 6px rgba(62, 122, 63, 0.4);
        }

        .input-group-text {
            background-color: var(--cafe-suave);
            border-color: var(--cafe-claro);
            color: var(--cafe-oscuro);
        }

        /* Validaciones */
        label.error {
            color: var(--rojo-alerta);
            font-size: 0.85rem;
            margin-top: 0.25rem;
            display: block;
        }

        input.error {
            border-color: var(--rojo-alerta) !important;
            background-color: #FCE4E4 !important;
        }

        /* Botón principal */
        .btn-primary {
            background-color: var(--verde) !important;
            border-color: var(--verde) !important;
            border-radius: .6rem;
            padding: 0.7rem;
            font-weight: bold;
            transition: .2s;
        }

        .btn-primary:hover {
            background-color: var(--verde-claro) !important;
            border-color: var(--verde-claro) !important;
        }

        /* Botón mostrar contraseña */
        #togglePassword {
            border-radius: 0 .6rem .6rem 0;
            background-color: var(--cafe-suave);
            border-color: var(--cafe-claro);
        }

        #togglePassword:hover {
            background-color: var(--cafe-claro);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .restaurant-title {
                font-size: 1.6rem;
            }
        }

        /* ================= LOGO LOGIN (LIMPIO Y ELEGANTE) ================= */

        .logo-container{
            padding: 1.5rem;
        }

        .logo-login{
            width: 220px;
            height: 220px;
            object-fit: cover;
            border-radius: 50%;
            box-shadow: 0 12px 30px rgba(0,0,0,0.35);
        }

        /* Texto bajo el logo */
        .logo-text{
            margin-top: 1rem;
            font-weight: 600;
            color: var(--cafe-profundo);
            letter-spacing: 0.5px;
        }

        .alert {
            border-radius: 12px;
            font-weight: 600;
            padding: 10px 12px;
            border-width: 1px;
        }

        /* ERROR (rojo elegante) */
        .alert-danger {
            background-color: #FCE4E4;
            color: var(--rojo-oscuro);
            border: 1px solid var(--rojo-alerta);
        }

        /* SUCCESS (verde elegante) */
        .alert-success {
            background-color: var(--exito-suave);
            color: var(--verde-profundo);
            border: 1px solid var(--exito);
        }

        /* INFO (azul elegante) */
        .alert-info {
            background-color: var(--info-suave);
            color: var(--azul-pizarra);
            border: 1px solid var(--info);
        }

        /* Opcional: iconito a la izquierda sin tocar tu lógica */
        .alert::before{
            display: inline-block;
            margin-right: 8px;
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            vertical-align: middle;
        }

        .alert-danger::before { content: "\f06a"; }  /* triangle exclamation */
        .alert-success::before { content: "\f058"; } /* circle-check */
        .alert-info::before { content: "\f05a"; }    /* circle-info */




    </style>

</head>
<body>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-sm-12 col-md-10 col-lg-8 col-xl-6">
            <div class="card login-card">
                <div class="row g-0">

                    <!-- Logo lateral -->
                    <div class="col-12 col-md-6 d-flex align-items-center justify-content-center bg-login-image">
                        <div class="logo-container text-center">
                            <img src="{% static 'logo/logo.jpeg' %}" alt="Logo Restaurante" class="logo-login logo-login-responsive">
                            <h5 class="mt-3 fw-bold logo-text">Productos Carlos Gerardo</h5>
                        </div>
                    </div>

                    <!-- Formulario -->
                    <div class="col-md-6 bg-white">
                        <div class="card-body p-4">

                            <div class="text-center mb-4">
                                <h2 class="restaurant-title">Bienvenido</h2>
                                <p class="text-muted">Inicia sesión para continuar</p>
                            </div>

                            <form id="frm_login" method="post" action="{% url 'iniciar_sesion' %}">
                                {% csrf_token %}

                               {% if messages %}
                                    {% for message in messages %}
                                        <div class="alert 
                                        {% if message.tags == 'error' %} alert-danger
                                        {% elif message.tags == 'success' %} alert-success
                                        {% elif message.tags == 'info' %} alert-info
                                        {% else %} alert-secondary
                                        {% endif %}
                                        py-2" role="alert">
                                        {{ message }}
                                        </div>
                                    {% endfor %}
                                {% endif %}

                                <!-- Correo -->
                                <div class="form-group mb-3">
                                    <label for="correo" class="fw-semibold">Correo electrónico</label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="fa-solid fa-envelope"></i>
                                        </span>
                                        <input id="correo" type="email" name="correo" class="form-control" placeholder="usuario@correo.com" required>
                                    </div>
                                </div>

                                <!-- Contraseña -->
                                <div class="form-group mb-4">
                                    <label for="password" class="fw-semibold">Contraseña</label>
                                    <div class="input-group position-relative">
                                        <span class="input-group-text">
                                            <i class="fa-solid fa-lock"></i>
                                        </span>
                                        <input type="password" id="password" name="password" class="form-control" placeholder="Contraseña" required>
                                        <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                            <i class="fa fa-eye"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fa-solid fa-right-to-bracket"></i>  Iniciar sesión
                                    </button>
                                </div>

                                <div class="text-center mt-3">
                                    <a href="{% url 'cliente_recuperar_password' %}"
                                    class="btn btn-link fw-semibold"
                                    style="color: var(--verde); text-decoration: none;">
                                        ¿Olvidaste tu contraseña?
                                    </a>
                                </div>

                                <div class="text-center mt-2">
                                    <a href="{% url 'cliente_reactivar_cuenta' %}"
                                    class="fw-semibold"
                                    style="color: var(--verde); text-decoration: none;">
                                        ¿Deseas reactivar tu cuenta?
                                    </a>
                                </div>

                                <div class="text-center mt-3">
                                    <p class="mb-1 text-muted">¿No tienes cuenta?</p>
                                    <a href="{% url 'registro_cliente' %}" class="fw-semibold" style="color: var(--verde);">
                                        Regístrate aquí
                                    </a>
                                </div>

                            </form>

                        </div>
                    </div>
                </div>
            </div>
        </div>
     </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Validación -->
<script>
$(function () {
    $("#frm_login").validate({
        rules: {
            correo: { required: true, email: true },
            password: { required: true }
        },
        messages: {
            correo: {
                required: "El correo es obligatorio",
                email: "Debe ingresar un correo válido"
            },
            password: {
                required: "La contraseña es obligatoria"
            }
        },

        errorElement: "label",
        errorClass: "error",

        highlight: function (element) {
            $(element).addClass("is-invalid");
        },
        unhighlight: function (element) {
            $(element).removeClass("is-invalid");
        },

        // Esto es lo clave: si el input está en input-group, el error va después del grupo
        errorPlacement: function (error, element) {
            const group = element.closest(".input-group");
            if (group.length) {
                error.insertAfter(group);
            } else {
                error.insertAfter(element);
            }
        }
    });
});
</script>

<!-- Mostrar / ocultar contraseña -->
<script>
    $("#togglePassword").on("click", function() {
        const input = $("#password");
        const icon = $(this).find("i");

        if (input.attr("type") === "password") {
            input.attr("type", "text");
            icon.removeClass("fa-eye").addClass("fa-eye-slash");
        } else {
            input.attr("type", "password");
            icon.removeClass("fa-eye-slash").addClass("fa-eye");
        }
    });
</script>

<script>
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("/sw.js", { scope: "/" });
    });
  }
</script>


</body>
</html>
