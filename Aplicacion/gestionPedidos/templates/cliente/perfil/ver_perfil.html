{% extends 'cliente/plantilla.html' %}
{% load static %}

{% block contenido %}
<br>

<style>
:root {
    --cafe-oscuro: #b4764f;
    --cafe-medio: #cd966c;
    --cafe-claro: #D7B999;
    --cafe-suave: #EEDDC6;

    --verde: #3E7A3F;
    --verde-claro: #7FBF6A;

    --blanco-calido: #F8F5F2;
    --gris-suave: #E2DED8;
    --texto-oscuro: #2B1A10;

    --rojo-alerta: #C14949;
    --rojo-oscuro: #8C2F39;

    --cafe-profundo: #8A5A3C;
    --advertencia: #D9A441;
    --advertencia-suave: #FFF5DA;
}

html, body {
    background: linear-gradient(
        135deg,
        var(--crema-suave),
        var(--cafe-suave) 45%,
        var(--blanco-calido)
    );
    overflow-x: hidden;
}

.perfil-container {
    max-width: 600px;
    margin: auto;
    padding: 20px;
}

.perfil-card {
    background: var(--blanco-calido);
    border: 1px solid var(--cafe-claro);
    border-radius: 20px;
    padding: 35px;
    box-shadow: 0 12px 25px rgba(0,0,0,0.12);
}

.perfil-header {
    text-align: center;
    margin-bottom: 25px;
}

.perfil-header h3 {
    color: var(--cafe-profundo);
    font-weight: 800;
    margin-top: 10px;
    font-size: 28px;
}

.perfil-dato {
    padding: 14px 0;
    border-bottom: 1px solid var(--gris-suave);
    font-size: 16px;
}

.perfil-dato span {
    font-weight: bold;
    color: var(--cafe-medio);
}

.btn-editar {
    background: var(--advertencia);
    color: white;
    width: 100%;
    padding: 13px;
    border-radius: 15px;
    font-weight: bold;
    font-size: 16px;
    margin-top: 25px;
    transition: 0.3s;
    border: none;
}

.btn-editar:hover {
    background: var(--advertencia-suave);
    color: var(--texto-oscuro);
    transform: translateY(-3px);
}

.btn-desactivar {
    background: var(--rojo-alerta);
    color: white;
    width: 100%;
    padding: 13px;
    border-radius: 15px;
    font-weight: bold;
    font-size: 16px;
    margin-top: 15px;
    transition: 0.3s;
    border: none;
}

.btn-desactivar:hover {
    background: var(--rojo-oscuro);
    color: white;
    transform: translateY(-3px);
}

</style>

<div class="perfil-container">
    <div class="perfil-card">

        <div class="perfil-header">
            <i class="fas fa-user-circle fa-4x" style="color: var(--cafe-oscuro);"></i>
            <h3>Perfil del Cliente</h3>
        </div>

        <div class="perfil-dato">
            <span>Nombre:</span> {{ usuario.nombre }} {{ usuario.apellido }}
        </div>

        <div class="perfil-dato">
            <span>Correo:</span> {{ usuario.correo }}
        </div>

        <div class="perfil-dato">
            <span>Teléfono:</span> {{ usuario.telefono|default:"No registrado" }}
        </div>

        <div class="perfil-dato">
            <span>Dirección:</span> {{ usuario.direccion|default:"No registrada" }}
        </div>

        <div class="perfil-dato">
            <span>Rol:</span> {{ usuario.get_rol_display }}
        </div>

        <a href="{% url 'cliente_editar_perfil' %}" class="btn btn-editar">
            <i class="fas fa-edit"></i> Editar Perfil
        </a>

        <form id="form-desactivar-cuenta"
            method="post"
            action="{% url 'cliente_desactivar_cuenta' %}"
            class="mt-3">
            {% csrf_token %}
            <button type="button"
                    id="btn-desactivar"
                    class="btn-desactivar">
                <i class="fas fa-user-slash"></i> Desactivar cuenta
            </button>
        </form>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
document.getElementById("btn-desactivar").addEventListener("click", function () {

    Swal.fire({
        title: "¿Estás seguro?",
        html: `
            <p>Esta acción puede tener las siguientes consecuencias:</p>
            <ul style="text-align:left">
                <li>Si tienes pedidos, tu cuenta será <b>desactivada</b>.</li>
                <li>Si NO tienes pedidos, tu cuenta será <b>eliminada definitivamente</b>.</li>
            </ul>
            <p><b>Esta acción no se puede deshacer.</b></p>
        `,
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#C14949",
        cancelButtonColor: "#6c757d",
        confirmButtonText: "Sí, continuar",
        cancelButtonText: "Cancelar",
        reverseButtons: true
    }).then((result) => {
        if (result.isConfirmed) {
            document.getElementById("form-desactivar-cuenta").submit();
        }
    });

});
</script>

{% endblock %}
